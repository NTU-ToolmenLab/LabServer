# install virtual for better debuging and somewhat
sudo apt-get install python3-pip
sudo pip3 install virtualenv
virtualenv env
source env/bin/active

# build LoginWeb
cd LoginWeb
vim tzfserver/start.py # modify secrect key and your url(this is bug I think)
touch log
chmod 666 log
docker build . -t linnil1/tzfserver
touch databse.db
chmod 666 database.db # it should be more private
docker run -it --rm -v $(pwd)/database.db:/app/database.db linnil1/tzfserver python3 -c 'from tzfserver import start;start.init_db();'
cd ..

# copy my_vnc
# ...

# Control docker to start or stop
cd DockerServer
docker build . -t linnil1/dockerserver
cd ..

# build example docker-firefox-vnc
cd UserDocker
docker build . -t linnil1/docker-firefox
cd ..

# create encrypt files of traefik
cd traefik/
docker pull traefik
openssl genrsa 1024 > host.key
chmod 400 host.key
openssl req -new -x509 -nodes -sha1 -days 365 -key host.key -out host.cert
cd ..

# Build IDP
cd IDP
git clone https://github.com/IdentityPython/pysaml2.git
docker build . -t linnil1/idp
cd ..

# modify docker-compose for
# 1. add user (only need to share network see docker-vnc for example),
# 2. change host
# 3. add docker network to extern ...
vim docker-compose.yml
docker run -it --rm -v $(pwd):/app/LoginWeb -v $(pwd)/database.db:/app/database.db linnil1/tzfserver python3 -c 'from tzfserver import start;start.add();'
